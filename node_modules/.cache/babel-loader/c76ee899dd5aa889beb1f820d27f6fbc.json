{"ast":null,"code":"var _jsxFileName = \"/home/luyao/Desktop/CS185/my_movie_site/src/components/GuestBook.js\";\nimport React, { useEffect, useState } from 'react';\nimport '../App.css';\nimport config from './config.js';\nimport useForm from './useForm';\nimport form_validate from './formValidate';\nimport { Alert } from 'reactstrap';\n/*\nnode node_modules/reac  t-scripts/scripts/start.js\n\nFix react page doesn't update on file change *WORKS*\nsudo -i\necho 1048576 > /proc/sys/fs/inotify/max_user_watches\nexit\n\n*/\n\nconst firebase = require('firebase');\n\nfunction GuestBook() {\n  const [data, setData] = useState([]);\n  const [shouldRender, setShouldRender] = useState(true);\n  let scrollRef = null; //used to refer scrollRef, so that on content change window is scrolled to bottom automaticallu\n\n  const guestBookStyle = {\n    backgroundColor: '#eadedb',\n    backgroundRepeat: 'repeat-y',\n    position: 'relative',\n    height: '80vh',\n    width: '100%',\n    display: 'flex',\n    //alignItems: 'center',\n    //justifyContent: 'center',\n    fontFamily: 'Raleway, sans-serif',\n    fontStyle: '2px',\n    //textTransform: 'uppercase',\n    letterSpacing: '1px'\n  };\n  const formInputFontStyle = {\n    fontFamily: 'Raleway, sans-serif',\n    fontStyle: '32px',\n    marginBottom: '20px'\n  };\n  const formInputDivStyle = {\n    position: 'relative',\n    fontSize: '12px',\n    left: '10vw',\n    top: '8vh'\n  };\n  const formPrintDivStyle = {\n    position: 'absolute',\n    left: '35vw',\n    top: '8vh',\n    width: '60vw',\n    height: '60vh',\n    border: 'dotted blue',\n    borderWidth: '2px',\n    borderColor: '#2a4944'\n  };\n  const formLabelFontStyle = {\n    fontFamily: 'lucida grande,arial',\n    fontSize: '1vw',\n    fontWeight: 'bold',\n    color: '#2E4A62',\n    position: 'relative',\n    top: '0vw',\n    left: '-1vw'\n  };\n  useEffect(() => {\n    console.log(\"shouldRender: \" + shouldRender);\n\n    if (!firebase.apps.length) {\n      firebase.initializeApp(config);\n    } //get a reference to the database\n\n\n    let ref = firebase.database().ref('data'); //retrieve its data       \n\n    ref.on('value', snapshot => {\n      const receivedJSON = snapshot.val();\n      console.log(receivedJSON);\n      snapshot.forEach(function (childSnapshot) {\n        var guestName = childSnapshot.child(\"guestName\").val();\n        var description = childSnapshot.child(\"description\").val();\n        var message = childSnapshot.child(\"message\").val();\n        var isPrivate = childSnapshot.child(\"isPrivate\").val();\n        var email = childSnapshot.child(\"email\").val();\n        var year = childSnapshot.child(\"year\").val();\n        var month = childSnapshot.child(\"month\").val();\n        var day = childSnapshot.child(\"day\").val();\n        console.log(guestName, description, message, isPrivate, email);\n        const newPack = [];\n        newPack.push(\"*Message on: \" + year + \"/\" + month + \"/\" + day + \"\\n\");\n        newPack.push(guestName + \"\\n\");\n        if (description.length != 0) newPack.push(description + \"\\n\");\n        newPack.push(message + \"\\n\");\n        if (email.length != 0) newPack.push(email);\n        newPack.push(\"\\n\\n\\n\"); //[guestName,\"\\n\",description,[{(description!=\"\") ? \"\\n\" : \"\"}],message,\"\\n\",email,\"\\n\\n\\n\"]\n\n        console.log(\"packed to: \" + newPack);\n\n        if (!isPrivate) {\n          setData(prevPack => [...prevPack, newPack]);\n        } else {\n          setValues({\n            guestName: \"\",\n            description: \"\",\n            message: \"\",\n            isPrivate: false,\n            email: \"\"\n          });\n          setErrors({\n            guestName: \"\",\n            description: \"\",\n            message: \"\",\n            isPrivate: \"\",\n            email: \"\",\n            hasError: \"\"\n          });\n          setVisible(true);\n        } //return true;       \n\n      }); //setData(state)\n\n      console.log(\"After receive, data: \" + data.map);\n    });\n  }, [shouldRender]);\n  /*Form Operations*/\n  //destructure event handler and values object from customized hook\n\n  const {\n    handleTextChange,\n    handleClickChange,\n    handleSubmit,\n    values,\n    setValues,\n    setErrors,\n    errors\n  } = useForm(submit, form_validate); //destructure from customized hook useForm\n  //\"submit\": useForm accepts a callback function name as argument when submit is clicked\n  //\"formValidate\": useForm accepts the validation logics to check user input\n\n  function submit() {\n    console.log(\"submitted successfully.\"); //'data' here is a field in my database that stores all my messages info\n\n    setData([]); //clear previous so that data don't duplicate\n    //set everything to default after submission\n\n    setValues({\n      guestName: \"\",\n      description: \"\",\n      message: \"\",\n      isPrivate: false,\n      email: \"\",\n      year: \"\",\n      month: \"\",\n      day: \"\"\n    });\n    setErrors({\n      guestName: \"\",\n      description: \"\",\n      message: \"\",\n      isPrivate: \"\",\n      email: \"\",\n      hasError: \"\"\n    });\n    firebase.database().ref('data').push().set(values);\n    setVisible(true); //setShouldRender({\n    //  shouldRender: true\n    //})\n  }\n\n  const [visible, setVisible] = useState(false);\n\n  const onafterprint = () => setVisible(false);\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"GuestBook\",\n    style: guestBookStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    noValidate: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: formInputDivStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    style: formLabelFontStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  }, \"Guest Name\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"guestName\",\n    type: \"guestName\",\n    value: values.guestName,\n    onChange: handleTextChange,\n    style: formInputFontStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 13\n    }\n  }), errors.guestName && /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 33\n    }\n  }, errors.guestName)), /*#__PURE__*/React.createElement(\"div\", {\n    style: formInputDivStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    style: formLabelFontStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }\n  }, \"Description (optional)\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"description\",\n    type: \"description\",\n    value: values.description,\n    onChange: handleTextChange,\n    style: formInputFontStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }\n  }), errors.description && /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 35\n    }\n  }, errors.description)), /*#__PURE__*/React.createElement(\"div\", {\n    style: formInputDivStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    style: formLabelFontStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }\n  }, \"Message\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"message\",\n    type: \"message\",\n    value: values.message,\n    onChange: handleTextChange,\n    style: formInputFontStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 13\n    }\n  }), errors.message && /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 32\n    }\n  }, errors.message)), /*#__PURE__*/React.createElement(\"div\", {\n    style: formInputDivStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    style: formLabelFontStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }\n  }, \"Choose isPrivate\"), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"isPrivate\",\n    type: \"checkbox\",\n    value: !values.isPrivate,\n    onClick: handleClickChange,\n    style: formInputFontStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: formInputDivStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    style: formLabelFontStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 13\n    }\n  }, \"Email (optional)\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"email\",\n    type: \"email\",\n    value: values.email,\n    onChange: handleTextChange,\n    style: formInputFontStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: formInputDivStyle,\n    onClick: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 13\n    }\n  }, \"submit\")), /*#__PURE__*/React.createElement(Alert, {\n    style: formInputDivStyle,\n    color: \"info\",\n    isOpen: visible,\n    toggle: onafterprint,\n    fade: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 11\n    }\n  }, \"Message sent successfully!\")), data.map((s, index) => /*#__PURE__*/React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 13\n    }\n  }, s)));\n}\n\nexport default GuestBook;","map":{"version":3,"sources":["/home/luyao/Desktop/CS185/my_movie_site/src/components/GuestBook.js"],"names":["React","useEffect","useState","config","useForm","form_validate","Alert","firebase","require","GuestBook","data","setData","shouldRender","setShouldRender","scrollRef","guestBookStyle","backgroundColor","backgroundRepeat","position","height","width","display","fontFamily","fontStyle","letterSpacing","formInputFontStyle","marginBottom","formInputDivStyle","fontSize","left","top","formPrintDivStyle","border","borderWidth","borderColor","formLabelFontStyle","fontWeight","color","console","log","apps","length","initializeApp","ref","database","on","snapshot","receivedJSON","val","forEach","childSnapshot","guestName","child","description","message","isPrivate","email","year","month","day","newPack","push","prevPack","setValues","setErrors","hasError","setVisible","map","handleTextChange","handleClickChange","handleSubmit","values","errors","submit","set","visible","onafterprint","s","index"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAO,YAAP;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,aAAP,MAA0B,gBAA1B;AAEA,SAASC,KAAT,QAAsB,YAAtB;AAEA;;;;;;;;;;AASA,MAAMC,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,SAASC,SAAT,GAAoB;AAChB,QAAM,CAACC,IAAD,EAAMC,OAAN,IAAiBT,QAAQ,CAAC,EAAD,CAA/B;AACA,QAAM,CAACU,YAAD,EAAgBC,eAAhB,IAAmCX,QAAQ,CAAC,IAAD,CAAjD;AAGA,MAAIY,SAAS,GAAG,IAAhB,CALgB,CAKM;;AAGtB,QAAMC,cAAc,GAAC;AAEjBC,IAAAA,eAAe,EAAE,SAFA;AAGjBC,IAAAA,gBAAgB,EAAE,UAHD;AAIjBC,IAAAA,QAAQ,EAAE,UAJO;AAKjBC,IAAAA,MAAM,EAAE,MALS;AAMjBC,IAAAA,KAAK,EAAE,MANU;AAOjBC,IAAAA,OAAO,EAAE,MAPQ;AAQjB;AACA;AACAC,IAAAA,UAAU,EAAE,qBAVK;AAWjBC,IAAAA,SAAS,EAAE,KAXM;AAYjB;AACAC,IAAAA,aAAa,EAAE;AAbE,GAArB;AAeA,QAAMC,kBAAkB,GAAC;AACvBH,IAAAA,UAAU,EAAE,qBADW;AAEvBC,IAAAA,SAAS,EAAE,MAFY;AAGvBG,IAAAA,YAAY,EAAE;AAHS,GAAzB;AAMA,QAAMC,iBAAiB,GAAC;AACtBT,IAAAA,QAAQ,EAAE,UADY;AAEtBU,IAAAA,QAAQ,EAAE,MAFY;AAGtBC,IAAAA,IAAI,EAAC,MAHiB;AAItBC,IAAAA,GAAG,EAAE;AAJiB,GAAxB;AAOA,QAAMC,iBAAiB,GAAC;AACtBb,IAAAA,QAAQ,EAAE,UADY;AAEtBW,IAAAA,IAAI,EAAC,MAFiB;AAGtBC,IAAAA,GAAG,EAAE,KAHiB;AAItBV,IAAAA,KAAK,EAAE,MAJe;AAKtBD,IAAAA,MAAM,EAAE,MALc;AAMtBa,IAAAA,MAAM,EAAE,aANc;AAOtBC,IAAAA,WAAW,EAAE,KAPS;AAQtBC,IAAAA,WAAW,EAAE;AARS,GAAxB;AAWA,QAAMC,kBAAkB,GAAC;AACvBb,IAAAA,UAAU,EAAE,qBADW;AAEvBM,IAAAA,QAAQ,EAAE,KAFa;AAGvBQ,IAAAA,UAAU,EAAE,MAHW;AAIvBC,IAAAA,KAAK,EAAE,SAJgB;AAKvBnB,IAAAA,QAAQ,EAAE,UALa;AAMvBY,IAAAA,GAAG,EAAE,KANkB;AAOvBD,IAAAA,IAAI,EAAC;AAPkB,GAAzB;AAYA5B,EAAAA,SAAS,CAAC,MAAM;AACZqC,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAmB3B,YAA/B;;AACA,QAAG,CAACL,QAAQ,CAACiC,IAAT,CAAcC,MAAlB,EAAyB;AACrBlC,MAAAA,QAAQ,CAACmC,aAAT,CAAuBvC,MAAvB;AACH,KAJW,CAMZ;;;AACA,QAAIwC,GAAG,GAAGpC,QAAQ,CAACqC,QAAT,GAAoBD,GAApB,CAAwB,MAAxB,CAAV,CAPY,CASZ;;AACAA,IAAAA,GAAG,CAACE,EAAJ,CAAQ,OAAR,EAAiBC,QAAQ,IAAI;AACzB,YAAMC,YAAY,GAAGD,QAAQ,CAACE,GAAT,EAArB;AACAV,MAAAA,OAAO,CAACC,GAAR,CAAYQ,YAAZ;AACAD,MAAAA,QAAQ,CAACG,OAAT,CAAiB,UAASC,aAAT,EAAuB;AACtC,YAAIC,SAAS,GAAGD,aAAa,CAACE,KAAd,CAAoB,WAApB,EAAiCJ,GAAjC,EAAhB;AACA,YAAIK,WAAW,GAAGH,aAAa,CAACE,KAAd,CAAoB,aAApB,EAAmCJ,GAAnC,EAAlB;AACA,YAAIM,OAAO,GAAGJ,aAAa,CAACE,KAAd,CAAoB,SAApB,EAA+BJ,GAA/B,EAAd;AACA,YAAIO,SAAS,GAAGL,aAAa,CAACE,KAAd,CAAoB,WAApB,EAAiCJ,GAAjC,EAAhB;AACA,YAAIQ,KAAK,GAAGN,aAAa,CAACE,KAAd,CAAoB,OAApB,EAA6BJ,GAA7B,EAAZ;AACA,YAAIS,IAAI,GAAGP,aAAa,CAACE,KAAd,CAAoB,MAApB,EAA4BJ,GAA5B,EAAX;AACA,YAAIU,KAAK,GAAGR,aAAa,CAACE,KAAd,CAAoB,OAApB,EAA6BJ,GAA7B,EAAZ;AACA,YAAIW,GAAG,GAAGT,aAAa,CAACE,KAAd,CAAoB,KAApB,EAA2BJ,GAA3B,EAAV;AAEAV,QAAAA,OAAO,CAACC,GAAR,CAAYY,SAAZ,EAAuBE,WAAvB,EAAoCC,OAApC,EAA6CC,SAA7C,EAAwDC,KAAxD;AAEA,cAAMI,OAAO,GAAC,EAAd;AACAA,QAAAA,OAAO,CAACC,IAAR,CAAa,kBAAkBJ,IAAlB,GAAyB,GAAzB,GAA+BC,KAA/B,GAAuC,GAAvC,GAA6CC,GAA7C,GAAmD,IAAhE;AACAC,QAAAA,OAAO,CAACC,IAAR,CAAaV,SAAS,GAAG,IAAzB;AACA,YAAGE,WAAW,CAACZ,MAAZ,IAAsB,CAAzB,EAA4BmB,OAAO,CAACC,IAAR,CAAaR,WAAW,GAAG,IAA3B;AAC5BO,QAAAA,OAAO,CAACC,IAAR,CAAaP,OAAO,GAAG,IAAvB;AACA,YAAGE,KAAK,CAACf,MAAN,IAAgB,CAAnB,EAAsBmB,OAAO,CAACC,IAAR,CAAaL,KAAb;AACtBI,QAAAA,OAAO,CAACC,IAAR,CAAa,QAAb,EAlBsC,CAmBtC;;AACAvB,QAAAA,OAAO,CAACC,GAAR,CAAY,gBAAgBqB,OAA5B;;AACA,YAAG,CAACL,SAAJ,EAAc;AACZ5C,UAAAA,OAAO,CAACmD,QAAQ,IAAI,CAAC,GAAGA,QAAJ,EAAaF,OAAb,CAAb,CAAP;AACD,SAFD,MAEM;AACJG,UAAAA,SAAS,CAAC;AAACZ,YAAAA,SAAS,EAAC,EAAX;AAAcE,YAAAA,WAAW,EAAC,EAA1B;AAA6BC,YAAAA,OAAO,EAAC,EAArC;AAAwCC,YAAAA,SAAS,EAAC,KAAlD;AAAwDC,YAAAA,KAAK,EAAC;AAA9D,WAAD,CAAT;AACAQ,UAAAA,SAAS,CAAC;AAACb,YAAAA,SAAS,EAAC,EAAX;AAAcE,YAAAA,WAAW,EAAC,EAA1B;AAA6BC,YAAAA,OAAO,EAAC,EAArC;AAAwCC,YAAAA,SAAS,EAAC,EAAlD;AAAqDC,YAAAA,KAAK,EAAC,EAA3D;AAA8DS,YAAAA,QAAQ,EAAC;AAAvE,WAAD,CAAT;AACAC,UAAAA,UAAU,CAAC,IAAD,CAAV;AACD,SA3BqC,CA4BtC;;AACD,OA7BD,EAHyB,CAiCzB;;AACA5B,MAAAA,OAAO,CAACC,GAAR,CAAY,0BAA0B7B,IAAI,CAACyD,GAA3C;AACH,KAnCD;AAoCH,GA9CQ,EA8CP,CAACvD,YAAD,CA9CO,CAAT;AAgDA;AACA;;AACA,QAAM;AAACwD,IAAAA,gBAAD;AAAmBC,IAAAA,iBAAnB;AAAsCC,IAAAA,YAAtC;AAAoDC,IAAAA,MAApD;AAA4DR,IAAAA,SAA5D;AAAuEC,IAAAA,SAAvE;AAAiFQ,IAAAA;AAAjF,MAA2FpE,OAAO,CAACqE,MAAD,EAAQpE,aAAR,CAAxG,CA7GgB,CA6GgH;AAClE;AACA;;AAG9D,WAASoE,MAAT,GAAiB;AACfnC,IAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ,EADe,CAEf;;AAEA5B,IAAAA,OAAO,CAAC,EAAD,CAAP,CAJe,CAIH;AAEZ;;AACAoD,IAAAA,SAAS,CAAC;AAACZ,MAAAA,SAAS,EAAC,EAAX;AAAcE,MAAAA,WAAW,EAAC,EAA1B;AAA6BC,MAAAA,OAAO,EAAC,EAArC;AAAwCC,MAAAA,SAAS,EAAC,KAAlD;AAAwDC,MAAAA,KAAK,EAAC,EAA9D;AAAiEC,MAAAA,IAAI,EAAC,EAAtE;AAAyEC,MAAAA,KAAK,EAAC,EAA/E;AAAkFC,MAAAA,GAAG,EAAC;AAAtF,KAAD,CAAT;AACAK,IAAAA,SAAS,CAAC;AAACb,MAAAA,SAAS,EAAC,EAAX;AAAcE,MAAAA,WAAW,EAAC,EAA1B;AAA6BC,MAAAA,OAAO,EAAC,EAArC;AAAwCC,MAAAA,SAAS,EAAC,EAAlD;AAAqDC,MAAAA,KAAK,EAAC,EAA3D;AAA8DS,MAAAA,QAAQ,EAAC;AAAvE,KAAD,CAAT;AAGA1D,IAAAA,QAAQ,CAACqC,QAAT,GAAoBD,GAApB,CAAwB,MAAxB,EAAgCkB,IAAhC,GAAuCa,GAAvC,CAA2CH,MAA3C;AACAL,IAAAA,UAAU,CAAC,IAAD,CAAV,CAZe,CAaf;AACA;AACA;AACD;;AACD,QAAM,CAACS,OAAD,EAAUT,UAAV,IAAwBhE,QAAQ,CAAC,KAAD,CAAtC;;AACA,QAAM0E,YAAY,GAAG,MAAMV,UAAU,CAAC,KAAD,CAArC;;AAEJ,sBACI;AAAK,IAAA,SAAS,EAAC,WAAf;AAA2B,IAAA,KAAK,EAAEnD,cAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAM,IAAA,QAAQ,EAAEuD,YAAhB;AAA8B,IAAA,UAAU,MAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEE;AAAK,IAAA,KAAK,EAAE3C,iBAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAO,IAAA,KAAK,EAAEQ,kBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,eAGE;AAAO,IAAA,IAAI,EAAC,WAAZ;AAAwB,IAAA,IAAI,EAAC,WAA7B;AAAyC,IAAA,KAAK,EAAEoC,MAAM,CAACpB,SAAvD;AAAkE,IAAA,QAAQ,EAAEiB,gBAA5E;AAA8F,IAAA,KAAK,EAAE3C,kBAArG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,EAKG+C,MAAM,CAACrB,SAAP,iBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAIqB,MAAM,CAACrB,SAAX,CALtB,CAFF,eAUE;AAAK,IAAA,KAAK,EAAExB,iBAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAO,IAAA,KAAK,EAAEQ,kBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,eAGE;AAAO,IAAA,IAAI,EAAC,aAAZ;AAA0B,IAAA,IAAI,EAAC,aAA/B;AAA6C,IAAA,KAAK,EAAEoC,MAAM,CAAClB,WAA3D;AAAwE,IAAA,QAAQ,EAAEe,gBAAlF;AAAoG,IAAA,KAAK,EAAE3C,kBAA3G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,EAIG+C,MAAM,CAACnB,WAAP,iBAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAImB,MAAM,CAACnB,WAAX,CAJxB,CAVF,eAiBE;AAAK,IAAA,KAAK,EAAE1B,iBAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAO,IAAA,KAAK,EAAEQ,kBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,eAGE;AAAO,IAAA,IAAI,EAAC,SAAZ;AAAsB,IAAA,IAAI,EAAC,SAA3B;AAAqC,IAAA,KAAK,EAAEoC,MAAM,CAACjB,OAAnD;AAA4D,IAAA,QAAQ,EAAEc,gBAAtE;AAAwF,IAAA,KAAK,EAAE3C,kBAA/F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,EAIG+C,MAAM,CAAClB,OAAP,iBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAIkB,MAAM,CAAClB,OAAX,CAJrB,CAjBF,eAwBE;AAAK,IAAA,KAAK,EAAE3B,iBAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAO,IAAA,KAAK,EAAEQ,kBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAO,IAAA,IAAI,EAAC,WAAZ;AAAwB,IAAA,IAAI,EAAC,UAA7B;AAAyC,IAAA,KAAK,EAAE,CAACoC,MAAM,CAAChB,SAAxD;AAAmE,IAAA,OAAO,EAAEc,iBAA5E;AAA+F,IAAA,KAAK,EAAE5C,kBAAtG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CAxBF,eA6BE;AAAK,IAAA,KAAK,EAAEE,iBAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAO,IAAA,KAAK,EAAEQ,kBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,eAGE;AAAO,IAAA,IAAI,EAAC,OAAZ;AAAoB,IAAA,IAAI,EAAC,OAAzB;AAAiC,IAAA,KAAK,EAAEoC,MAAM,CAACf,KAA/C;AAAsD,IAAA,QAAQ,EAAEY,gBAAhE;AAAkF,IAAA,KAAK,EAAE3C,kBAAzF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,CA7BF,eAmCE;AAAK,IAAA,KAAK,EAAEE,iBAAZ;AAA+B,IAAA,OAAO,EAAE2C,YAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAQ,IAAA,IAAI,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,CAnCF,eAwCE,oBAAC,KAAD;AAAO,IAAA,KAAK,EAAE3C,iBAAd;AAAiC,IAAA,KAAK,EAAC,MAAvC;AAA8C,IAAA,MAAM,EAAEgD,OAAtD;AAA+D,IAAA,MAAM,EAAEC,YAAvE;AAAqF,IAAA,IAAI,EAAE,IAA3F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAxCF,CADJ,EA+COlE,IAAI,CAACyD,GAAL,CAAS,CAACU,CAAD,EAAGC,KAAH,kBACR,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACED,CADF,CADD,CA/CP,CADJ;AA8DC;;AAGD,eAAepE,SAAf","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport '../App.css'\nimport config from './config.js'\nimport useForm from './useForm'\nimport form_validate from './formValidate'\n\nimport { Alert } from 'reactstrap';\n\n/*\nnode node_modules/reac  t-scripts/scripts/start.js\n\nFix react page doesn't update on file change *WORKS*\nsudo -i\necho 1048576 > /proc/sys/fs/inotify/max_user_watches\nexit\n\n*/\nconst firebase = require('firebase')\n\nfunction GuestBook(){\n    const [data,setData] = useState([])\n    const [shouldRender , setShouldRender] = useState(true)\n    \n\n    let scrollRef = null; //used to refer scrollRef, so that on content change window is scrolled to bottom automaticallu\n\n\n    const guestBookStyle={\n       \n        backgroundColor: '#eadedb',\n        backgroundRepeat: 'repeat-y',\n        position: 'relative',\n        height: '80vh',\n        width: '100%',\n        display: 'flex',\n        //alignItems: 'center',\n        //justifyContent: 'center',\n        fontFamily: 'Raleway, sans-serif',\n        fontStyle: '2px', \n        //textTransform: 'uppercase',\n        letterSpacing: '1px'\n    }\n    const formInputFontStyle={\n      fontFamily: 'Raleway, sans-serif',\n      fontStyle: '32px', \n      marginBottom: '20px',\n    }\n\n    const formInputDivStyle={\n      position: 'relative',\n      fontSize: '12px',\n      left:'10vw',\n      top: '8vh'\n    }\n\n    const formPrintDivStyle={\n      position: 'absolute',\n      left:'35vw',\n      top: '8vh',\n      width: '60vw',\n      height: '60vh',\n      border: 'dotted blue',\n      borderWidth: '2px',\n      borderColor: '#2a4944',\n    }\n\n    const formLabelFontStyle={\n      fontFamily: 'lucida grande,arial',\n      fontSize: '1vw',\n      fontWeight: 'bold',\n      color: '#2E4A62',\n      position: 'relative',\n      top: '0vw',\n      left:'-1vw'\n    }\n   \n    \n\n    useEffect(() => {\n        console.log(\"shouldRender: \" + shouldRender);\n        if(!firebase.apps.length){\n            firebase.initializeApp(config)\n        }\n\n        //get a reference to the database\n        let ref = firebase.database().ref('data')\n\n        //retrieve its data       \n        ref.on( 'value', snapshot => {\n            const receivedJSON = snapshot.val()\n            console.log(receivedJSON);\n            snapshot.forEach(function(childSnapshot){\n              var guestName = childSnapshot.child(\"guestName\").val();\n              var description = childSnapshot.child(\"description\").val();\n              var message = childSnapshot.child(\"message\").val();\n              var isPrivate = childSnapshot.child(\"isPrivate\").val();\n              var email = childSnapshot.child(\"email\").val();\n              var year = childSnapshot.child(\"year\").val();\n              var month = childSnapshot.child(\"month\").val();\n              var day = childSnapshot.child(\"day\").val();\n\n              console.log(guestName, description, message, isPrivate, email)\n              \n              const newPack=[];\n              newPack.push(\"*Message on: \" + year + \"/\" + month + \"/\" + day + \"\\n\");\n              newPack.push(guestName + \"\\n\");\n              if(description.length != 0) newPack.push(description + \"\\n\");\n              newPack.push(message + \"\\n\");\n              if(email.length != 0) newPack.push(email);\n              newPack.push(\"\\n\\n\\n\");\n              //[guestName,\"\\n\",description,[{(description!=\"\") ? \"\\n\" : \"\"}],message,\"\\n\",email,\"\\n\\n\\n\"]\n              console.log(\"packed to: \" + newPack)\n              if(!isPrivate){\n                setData(prevPack => [...prevPack,newPack])\n              }else {\n                setValues({guestName:\"\",description:\"\",message:\"\",isPrivate:false,email:\"\"}) \n                setErrors({guestName:\"\",description:\"\",message:\"\",isPrivate:\"\",email:\"\",hasError:\"\"})\n                setVisible(true);\n              }\n              //return true;       \n            })\n            //setData(state)\n            console.log(\"After receive, data: \" + data.map);\n        })\n    },[shouldRender])\n\n    /*Form Operations*/\n    //destructure event handler and values object from customized hook\n    const {handleTextChange, handleClickChange, handleSubmit, values, setValues, setErrors,errors} = useForm(submit,form_validate); //destructure from customized hook useForm\n                                                                  //\"submit\": useForm accepts a callback function name as argument when submit is clicked\n                                                                  //\"formValidate\": useForm accepts the validation logics to check user input\n  \n\n    function submit(){\n      console.log(\"submitted successfully.\")\n      //'data' here is a field in my database that stores all my messages info\n\n      setData([]) //clear previous so that data don't duplicate\n  \n      //set everything to default after submission\n      setValues({guestName:\"\",description:\"\",message:\"\",isPrivate:false,email:\"\",year:\"\",month:\"\",day:\"\"}) \n      setErrors({guestName:\"\",description:\"\",message:\"\",isPrivate:\"\",email:\"\",hasError:\"\"})\n      \n\n      firebase.database().ref('data').push().set(values);\n      setVisible(true);\n      //setShouldRender({\n      //  shouldRender: true\n      //})\n    }\n    const [visible, setVisible] = useState(false);\n    const onafterprint = () => setVisible(false);\n\nreturn(\n    <div className=\"GuestBook\" style={guestBookStyle}>\n        <form onSubmit={handleSubmit} noValidate>\n        \n          <div style={formInputDivStyle}> \n            <label style={formLabelFontStyle}>Guest Name</label>\n            <br/>\n            <input name=\"guestName\" type=\"guestName\" value={values.guestName} onChange={handleTextChange} style={formInputFontStyle}/>\n            {/*conditional rendering, displays the error _message_ written in formValidate */}\n            {errors.guestName&& <p>{errors.guestName}</p>} \n          </div>\n          \n          <div style={formInputDivStyle}>\n            <label style={formLabelFontStyle}>Description (optional)</label>\n            <br/>\n            <input name=\"description\" type=\"description\" value={values.description} onChange={handleTextChange} style={formInputFontStyle}/>\n            {errors.description&& <p>{errors.description}</p>}\n          </div>\n          \n          <div style={formInputDivStyle}>\n            <label style={formLabelFontStyle}>Message</label>\n            <br/>\n            <input name=\"message\" type=\"message\" value={values.message} onChange={handleTextChange} style={formInputFontStyle}/>\n            {errors.message && <p>{errors.message}</p>} \n          </div>\n\n          <div style={formInputDivStyle}>\n            <label style={formLabelFontStyle}>Choose isPrivate</label>\n            <input name=\"isPrivate\" type=\"checkbox\"  value={!values.isPrivate} onClick={handleClickChange} style={formInputFontStyle}/>\n          </div>\n            \n          <div style={formInputDivStyle}>\n            <label style={formLabelFontStyle}>Email (optional)</label>\n            <br/>\n            <input name=\"email\" type=\"email\" value={values.email} onChange={handleTextChange} style={formInputFontStyle}/>\n\n          </div>\n          <div style={formInputDivStyle} onClick={handleSubmit} >\n            <button type=\"submit\">submit</button>\n          </div>\n\n          {/*alert message that is hidden until submit */}\n          <Alert style={formInputDivStyle} color=\"info\" isOpen={visible} toggle={onafterprint} fade={true} >\n            Message sent successfully!\n          </Alert>\n        </form>\n        \n        \n          {data.map((s,index) => (\n            <Text> \n             {s}\n            </Text>\n          ))}\n          \n\n        \n\n        \n    </div>\n)\n\n\n}\n\n\nexport default GuestBook;"]},"metadata":{},"sourceType":"module"}